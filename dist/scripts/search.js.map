{"version":3,"sources":["../../scripts/search.js"],"names":["Search","el","$el","$input","querySelector","$songs","addEventListener","onKeyUp","bind","keyword","page","songs","perpage","event","target","value","trim","console","log","innerHTML","key","search","fetch","then","res","json","data","song","list","append","html","map","songname","singer","name","join"],"mappings":";;;;;;IAAMA,M;AACF,oBAAYC,EAAZ,EAAgB;AAAA;;AACZ,aAAKC,GAAL,GAAWD,EAAX;AACA,aAAKE,MAAL,GAAc,KAAKD,GAAL,CAASE,aAAT,CAAuB,SAAvB,CAAd;AACA,aAAKC,MAAL,GAAc,KAAKH,GAAL,CAASE,aAAT,CAAuB,oBAAvB,CAAd;AACA,aAAKD,MAAL,CAAYG,gBAAZ,CAA6B,OAA7B,EAAqC,KAAKC,OAAL,CAAaC,IAAb,CAAkB,IAAlB,CAArC;AACA,aAAKC,OAAL,GAAe,EAAf;AACA,aAAKC,IAAL,GAAY,CAAZ;AACA,aAAKC,KAAL,GAAa,EAAb;AACA,aAAKC,OAAL,GAAe,EAAf;AACH;;;;gCAEOC,K,EAAM;AACV,gBAAIJ,UAAUI,MAAMC,MAAN,CAAaC,KAAb,CAAmBC,IAAnB,EAAd;AACAC,oBAAQC,GAAR,CAAYT,OAAZ;AACA,gBAAGA,WAAW,EAAd,EAAkB,OAAO,KAAKJ,MAAL,CAAYc,SAAZ,GAAwB,EAA/B;AAClB,gBAAGN,MAAMO,GAAN,KAAc,OAAjB,EAA0B;AAC1B,iBAAKC,MAAL,CAAYZ,OAAZ;AACH;;;+BAEMA,O,EAAQ;AAAA;;AACX,iBAAKA,OAAL,GAAeA,OAAf;AACAa,4DAA8C,KAAKb,OAAnD,cAAmE,KAAKC,IAAxE,EACKa,IADL,CACU;AAAA,uBAAOC,IAAIC,IAAJ,EAAP;AAAA,aADV,EAEKF,IAFL,CAEU;AAAA,uBAAQE,KAAKC,IAAL,CAAUC,IAAV,CAAeC,IAAvB;AAAA,aAFV,EAGKL,IAHL,CAGU;AAAA,uBAAS,MAAKM,MAAL,CAAYlB,KAAZ,CAAT;AAAA,aAHV;AAIH;;;+BAEMA,K,EAAM;AACT,gBAAImB,OAAOnB,MAAMoB,GAAN,CAAU;AAAA,yMAKHJ,KAAKK,QALF,sCAMJL,KAAKM,MAAL,CAAYF,GAAZ,CAAgB;AAAA,2BAAUE,OAAOC,IAAjB;AAAA,iBAAhB,EAAuCC,IAAvC,CAA4C,GAA5C,CANI;AAAA,aAAV,EASTA,IATS,CASJ,EATI,CAAX;AAUA,iBAAK9B,MAAL,CAAYc,SAAZ,GAAwBW,IAAxB;AACH","file":"search.js","sourcesContent":["class Search{\r\n    constructor(el) {\r\n        this.$el = el\r\n        this.$input = this.$el.querySelector(\".search\")\r\n        this.$songs = this.$el.querySelector(\".search-content ul\")\r\n        this.$input.addEventListener(\"keyup\",this.onKeyUp.bind(this))\r\n        this.keyword = ''\r\n        this.page = 1\r\n        this.songs = []\r\n        this.perpage = 20\r\n    }\r\n\r\n    onKeyUp(event){\r\n        let keyword = event.target.value.trim()\r\n        console.log(keyword)\r\n        if(keyword == '') return this.$songs.innerHTML = \"\"\r\n        if(event.key !== \"Enter\") return\r\n        this.search(keyword)\r\n    }\r\n\r\n    search(keyword){\r\n        this.keyword = keyword\r\n        fetch(`http://localhost:4000/search?keyword=${this.keyword}&page=${this.page}`)\r\n            .then(res => res.json())\r\n            .then(json => json.data.song.list)\r\n            .then(songs => this.append(songs))\r\n    }\r\n\r\n    append(songs){\r\n        let html = songs.map(song =>`<li>\r\n                <div class=\"img\">\r\n                    <i class=\"icon\"></i>\r\n                </div>\r\n                <div class=\"text\">\r\n                    <h4>${song.songname}</h4>\r\n                    <p>${song.singer.map(singer => singer.name).join(\"/\")}</p>\r\n                </div>\r\n            </li>`\r\n        ).join(\"\")\r\n        this.$songs.innerHTML = html\r\n    }\r\n}"]}