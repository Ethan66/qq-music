{"version":3,"sources":["../../scripts/lazyload.js"],"names":["lazyload","images","imgs","slice","call","scrollEvent","throttle","console","log","Date","length","window","removeEventListener","filter","img","classList","contains","forEach","inViewport","loadImage","addEventListener","dispatchEvent","Event","fn","time","prev","timer","func","cur","diff","clearTimeout","setTimeout","getBoundingClientRect","top","right","bottom","left","vpWidth","document","documentElement","clientWidth","vpHeight","clientHeight","image","Image","src","dataset","onload","remove"],"mappings":";;AAAA,SAASA,QAAT,CAAkBC,MAAlB,EAAyB;AACrB,QAAIC,OAAO,GAAGC,KAAH,CAASC,IAAT,CAAcH,MAAd,CAAX;;AAEA,QAAII,cAAcC,SAAS,YAAW;AAClCC,gBAAQC,GAAR,CAAY,IAAIC,IAAJ,EAAZ;AACI,YAAG,CAACP,KAAKQ,MAAT,EAAiB;AACb,mBAAOC,OAAOC,mBAAP,CAA2B,QAA3B,EAAoCP,WAApC,CAAP;AACH;AACDH,eAAOA,KAAKW,MAAL,CAAY;AAAA,mBAAOC,IAAIC,SAAJ,CAAcC,QAAd,CAAuB,UAAvB,CAAP;AAAA,SAAZ,CAAP;AACAd,aAAKe,OAAL,CAAa,eAAO;AAChB,gBAAGC,WAAWJ,GAAX,CAAH,EAAoB;AAChBK,0BAAUL,GAAV;AACH;AACJ,SAJD;AAKH,KAXa,EAWZ,GAXY,CAAlB;;AAaAH,WAAOS,gBAAP,CAAwB,QAAxB,EAAiCf,WAAjC;AACAM,WAAOU,aAAP,CAAqB,IAAIC,KAAJ,CAAU,QAAV,CAArB;AACH;;AAID,SAAShB,QAAT,CAAkBiB,EAAlB,EAAqBC,IAArB,EAA0B;AACtB,QAAIC,aAAJ;AAAA,QAAUC,cAAV;AACA,WAAO,SAASC,IAAT,GAAe;AAClB,YAAIC,MAAM,IAAInB,IAAJ,EAAV;AACA,YAAIoB,OAAOD,MAAMH,IAAjB;AACA,YAAG,CAACA,IAAD,IAASI,QAAQL,IAApB,EAA0B;AACtBD;AACAE,mBAAOG,GAAP;AACH,SAHD,MAGO,IAAGC,QAAQL,IAAX,EAAgB;AACnBM,yBAAaJ,KAAb;AACAA,oBAAQK,WAAWJ,IAAX,EAAiBE,OAAOL,IAAxB,CAAR;AACH;AACJ,KAVD;AAWH;;AAED,SAASN,UAAT,CAAoBJ,GAApB,EAAwB;AAAA,gCACaA,IAAIkB,qBAAJ,EADb;AAAA,QACfC,GADe,yBACfA,GADe;AAAA,QACVC,KADU,yBACVA,KADU;AAAA,QACHC,MADG,yBACHA,MADG;AAAA,QACKC,IADL,yBACKA,IADL;;AAEpB,QAAIC,UAAUC,SAASC,eAAT,CAAyBC,WAAvC;AACA,QAAIC,WAAWH,SAASC,eAAT,CAAyBG,YAAxC;AACA,WACI,CAACT,MAAM,CAAN,IAAWA,MAAMQ,QAAjB,IAA6BN,SAAS,CAAT,IAAcA,SAASM,QAArD,MACCL,OAAO,CAAP,IAAYA,OAAOC,OAAnB,IAA8BH,QAAQ,CAAR,IAAaA,QAAOG,OADnD,CADJ;AAIH;;AAED,SAASlB,SAAT,CAAmBL,GAAnB,EAAuB;AACnB,QAAI6B,QAAQ,IAAIC,KAAJ,EAAZ;AACAD,UAAME,GAAN,GAAY/B,IAAIgC,OAAJ,CAAYD,GAAxB;AACAF,UAAMI,MAAN,GAAe,YAAU;AACrBjC,YAAI+B,GAAJ,GAAUF,MAAME,GAAhB;AACA/B,YAAIC,SAAJ,CAAciC,MAAd,CAAqB,UAArB;AACH,KAHD;AAIH","file":"lazyload.js","sourcesContent":["function lazyload(images){\r\n    let imgs = [].slice.call(images)\r\n\r\n    let scrollEvent = throttle(function() {\r\n        console.log(new Date())\r\n            if(!imgs.length) {\r\n                return window.removeEventListener(\"scroll\",scrollEvent)\r\n            }\r\n            imgs = imgs.filter(img => img.classList.contains(\"lazyload\"))\r\n            imgs.forEach(img => {\r\n                if(inViewport(img)) {\r\n                    loadImage(img)\r\n                }\r\n            })\r\n        },500)\r\n\r\n    window.addEventListener(\"scroll\",scrollEvent)\r\n    window.dispatchEvent(new Event('scroll'))\r\n}\r\n\r\n\r\n\r\nfunction throttle(fn,time){\r\n    let prev, timer\r\n    return function func(){\r\n        let cur = new Date()\r\n        let diff = cur - prev\r\n        if(!prev || diff >= time) {\r\n            fn()\r\n            prev = cur\r\n        } else if(diff <= time){\r\n            clearTimeout(timer)\r\n            timer = setTimeout(func, diff - time)\r\n        }\r\n    }\r\n}\r\n\r\nfunction inViewport(img){\r\n    let {top, right, bottom, left} = img.getBoundingClientRect()\r\n    let vpWidth = document.documentElement.clientWidth\r\n    let vpHeight = document.documentElement.clientHeight\r\n    return (\r\n        (top > 0 && top < vpHeight || bottom > 0 && bottom < vpHeight) &&\r\n        (left > 0 && left < vpWidth || right > 0 && right< vpWidth)\r\n    )\r\n}\r\n\r\nfunction loadImage(img){\r\n    let image = new Image()\r\n    image.src = img.dataset.src\r\n    image.onload = function(){\r\n        img.src = image.src\r\n        img.classList.remove(\"lazyload\")\r\n    }\r\n}"]}